/*
 * MWS Admin v2.1 - PickList JS
 * This file is part of MWS Admin, an Admin template build for sale at ThemeForest.
 * All copyright to this file is hold by Mairel Theafila <maimairel@yahoo.com> a.k.a nagaemas on ThemeForest.
 * Last Updated:
 * December 08, 2012
 *
 * 'Highly configurable' mutable plugin boilerplate
 * Author: @markdalgleish
 * Further changes, comments: @addyosmani
 * Licensed under the MIT license
 *
 */

;(function(c,k,l,h){var i=function(a,b){arguments.length&&this._init(a,b)},j=0;i.prototype={defaults:{mainClass:"pickList",listContainerClass:"pickList_listContainer",sourceListContainerClass:"pickList_sourceListContainer",controlsContainerClass:"pickList_controlsContainer",targetListContainerClass:"pickList_targetListContainer",listClass:"pickList_list",sourceListClass:"pickList_sourceList",targetListClass:"pickList_targetList",listItemClass:"pickList_listItem",selectedListItemClass:"pickList_selectedListItem",
filterContainerClass:"pickList_filter",sourceFilterClass:"pickList_sourceFilter",targetFilterClass:"pickList_targetFilter",addAllClass:"pickList_addAll",addClass:"pickList_add",removeAllClass:"pickList_removeAll",removeClass:"pickList_remove",addAllLabel:"&gt;&gt",addLabel:"&gt;",removeAllLabel:"&lt;&lt;",removeLabel:"&lt;",sourceListLabel:"Available Options",targetListLabel:"Selected Options",listLabelClass:"pickList_listLabel",sourceListLabelClass:"pickList_sourceListLabel",targetListLabelClass:"pickList_targetListLabel",
enableCounters:!0,enableFilters:!0,sortList:!0,guidPrefix:"pl"},_init:function(a,b){this.element=c(a);this.options=c.extend({},this.defaults,b,this.element.data());this._itemDictionary={};this._buildPickList();this._refresh()},_buildPickList:function(){this.element.attr("multiple")||this.element.attr("multiple",!0).html(this.element.html());this._pickList=c("<div></div>").addClass(this.options.mainClass).append(this._buildList("source")).append(this._buildControls()).append(this._buildList("target"));
this._populateLists();this._pickList.insertAfter(this.element.hide())},_buildList:function(a){var b=c("<div></div>").addClass(this.options.listContainerClass).addClass(this.options[a+"ListContainerClass"]);this[a+"Label"]=c("<div></div>").text(this.options[a+"ListLabel"]).addClass(this.options.listLabelClass).addClass(this.options[a+"ListLabelClass"]).append(c("<span></span>").toggle(this.options.showCounters));this[a+"List"]=c("<ul></ul>").addClass(this.options.listClass).addClass(this.options[a+
"ListClass"]).delegate("li","click",{pickList:this},this._changeHandler).css({"-moz-user-select":"none","-webkit-user-select":"none","user-select":"none","-ms-user-select":"none"}).each(function(){this.onselectstart=function(){return!1}});c("<div></div>").append(this[a+"Label"]).append(this[a+"List"]).appendTo(b);a=c("<div></div>",{"class":this.options.filterContainerClass,css:{display:"none"}}).addClass(this.options[a+"FilterClass"]).append(c('<input type="text">')).insertAfter(this[a+"Label"]);
this.options.enableFilters&&a.find('input[type="text"]').on("keyup",c.proxy(this._filterHandler,this)).end().show();return b},_buildControls:function(){this.controls=c("<div></div>").addClass(this.options.controlsContainerClass);this.addAllButton=c('<button class="btn"></button>').on("click",c.proxy(this._addAllHandler,this)).html(this.options.addAllLabel).addClass(this.options.addAllClass);this.addButton=c('<button class="btn"></button>').on("click",c.proxy(this._addHandler,this)).html(this.options.addLabel).addClass(this.options.addClass);
this.removeButton=c('<button class="btn"></button>').on("click",c.proxy(this._removeHandler,this)).html(this.options.removeLabel).addClass(this.options.removeClass);this.removeAllButton=c('<button class="btn"></button>').on("click",c.proxy(this._removeAllHandler,this)).html(this.options.removeAllLabel).addClass(this.options.removeAllClass);this.controls.append(this.addAllButton).append(this.addButton).append(this.removeButton).append(this.removeAllButton);return this.controls},_populateLists:function(){var a=
this,b=0>=a.element[0].selectedIndex,e=a._generateRandomId();a.element.children().each(function(){var d=c(this),g=d.text(),f=e+"_"+c(this).index(),g=c("<li></li>").text(g).attr("id",f).addClass(a.options.listItemClass);a._itemDictionary[f]=d;b||!d.is(":selected")?a.sourceList.append(g):a.targetList.append(g)});a.options.sortList&&(a._sortItems(a.sourceList),a._sortItems(a.targetList))},_addItem:function(a){var b=this;a.each(function(a,d){b.targetList.append(b._removeSelection(c(d)));itemId=c(d).attr("id");
b._itemDictionary[itemId].attr("selected",!0)});b.options.sortList&&(b._sortItems(b.sourceList),b._sortItems(b.targetList))},_removeItem:function(a){var b=this;a.each(function(a,d){b.sourceList.append(b._removeSelection(c(d)));itemId=c(d).attr("id");b._itemDictionary[itemId].removeAttr("selected")});b.options.sortList&&(b._sortItems(b.sourceList),b._sortItems(b.targetList))},_filterHandler:function(a){if(this.options.enableFilters){var b=this,a=c(a.target),e=a.val().toString().toLowerCase();a.parent().next().children("li").show().filter(function(){return-1==
c(this).text().toString().toLowerCase().indexOf(e)}).each(function(a,e){b._removeSelection(c(e)).hide()});this._refresh()}},_addAllHandler:function(a){this._addItem(this.sourceList.children(":visible"));this._refresh();a.preventDefault()},_addHandler:function(a){this._addItem(this.sourceList.children(".pickList_selected:visible"));this._refresh();a.preventDefault()},_removeHandler:function(a){this._removeItem(this.targetList.children(".pickList_selected:visible"));this._refresh();a.preventDefault()},
_removeAllHandler:function(a){this._removeItem(this.targetList.children(":visible"));this._refresh();a.preventDefault()},_refresh:function(){var a=this;a.sourceList.children("li:visible").length?a.addAllButton.removeAttr("disabled"):a.addAllButton.attr("disabled",!0);a.targetList.children("li:visible").length?a.removeAllButton.removeAttr("disabled"):a.removeAllButton.attr("disabled",!0);a.sourceList.children(".pickList_selected:visible").length?a.addButton.removeAttr("disabled"):a.addButton.attr("disabled",
!0);a.targetList.children(".pickList_selected:visible").length?a.removeButton.removeAttr("disabled"):a.removeButton.attr("disabled",!0);a.options.showCounters&&c.each(["source","target"],function(b,e){var d=a[e+"List"].children("li");c("span",a[e+"Label"]).text(a._formatString(" - showing {0} of {1}",d.filter(":visible").length,d.length))})},_sortItems:function(a){var b=a.children("li");b.sort(function(a,b){return c(a).text().toLowerCase().localeCompare(c(b).text().toLowerCase())});c.each(b,function(b,
c){a.append(c)})},_changeHandler:function(a){var b=a.data.pickList;if(a.ctrlKey)b._isSelected(c(this))?b._removeSelection(c(this)):(b.lastSelectedItem=c(this),b._addSelection(c(this)));else if(a.shiftKey){var e=c(this).get(0),d=b.lastSelectedItem.get(0);c(this).index()<c(b.lastSelectedItem).index()&&(a=e,e=d,d=a);var g=!1,f=!0;b._clearSelections(c(this).parent());c(this).parent().children(":visible").each(function(){c(this).get(0)==d&&(g=!0);g&&f&&b._addSelection(c(this));c(this).get(0)==e&&(f=!1)})}else b.lastSelectedItem=
c(this),b._clearSelections(c(this).parent()),b._addSelection(c(this));b._refresh()},_isSelected:function(a){return a.hasClass("pickList_selected")},_addSelection:function(a){return a.addClass("pickList_selected").addClass(this.options.selectedListItemClass)},_removeSelection:function(a){return a.removeClass("pickList_selected").removeClass(this.options.selectedListItemClass)},_clearSelections:function(a){var b=this;a.children().each(function(){b._removeSelection(c(this))})},_generateRandomId:function(){var a=
(new Date).getTime().toString(32),b;for(b=0;5>b;b++)a+=Math.floor(65535*Math.random()).toString(32);return this.options.guidPrefix+a+(j++).toString(32)},_formatString:function(a){var b=[].splice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})},option:function(a,b){if(0===arguments.length)return c.extend({},this.options);if("string"===typeof a){if(b===h)return this.options[a];this.options[a]=b}return this},destroy:function(){this.pickList.remove();
this.element.show()}};c.fn.pickList=function(a){var b="string"===typeof a,e=Array.prototype.slice.call(arguments,1),d=this;if(b&&"_"===a.charAt(0))return d;b?this.each(function(){var b=c.data(this,"pickList"),f=b&&c.isFunction(b[a])?b[a].apply(b,e):b;if(f!==b&&f!==h)return d=f,!1}):this.each(function(){c.data(this,"pickList")||c.data(this,"pickList",new i(this,a))});return d}})(jQuery,window,document);